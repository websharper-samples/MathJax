function ignore(){}function id(n){return n}function fst(n){return n[0]}function snd(n){return n[1]}function trd(n){return n[2]}IntelliFactory={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i in n)t[i]=n[i];return t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return IntelliFactory.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:IntelliFactory.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};IntelliFactory.Runtime.OnLoad(function(){self.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});console||(console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore});
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP;a=self;b=a.Samples=a.Samples||{};c=b.TeXInput=b.TeXInput||{};d=a.WebSharper=a.WebSharper||{};e=d.Obj=d.Obj||{};f=d.UI=d.UI||{};g=f.Var$1=f.Var$1||{};h=f.Var=f.Var||{};i=d.Operators=d.Operators||{};j=f.Templating=f.Templating||{};k=j.Runtime=j.Runtime||{};l=k.Server=k.Server||{};m=l.TemplateInstance=l.TemplateInstance||{};n=d.Arrays=d.Arrays||{};o=l.ProviderBuilder=l.ProviderBuilder||{};p=l.Handler=l.Handler||{};q=a.MathJax_Templates=a.MathJax_Templates||{};r=f.View=f.View||{};s=f.ConcreteVar=f.ConcreteVar||{};t=f.Snap=f.Snap||{};u=f.Client=f.Client||{};v=u.Templates=u.Templates||{};w=f.Doc=f.Doc||{};x=d.JavaScript=d.JavaScript||{};y=x.Pervasives=x.Pervasives||{};z=d.Collections=d.Collections||{};A=z.List=z.List||{};B=d.Unchecked=d.Unchecked||{};C=a.System=a.System||{};D=C.Guid=C.Guid||{};E=z.Dictionary=z.Dictionary||{};F=z.HashSet=z.HashSet||{};G=k.Client=k.Client||{};H=d.Seq=d.Seq||{};I=f.AttrModule=f.AttrModule||{};J=f.Abbrev=f.Abbrev||{};K=J.Fresh=J.Fresh||{};L=a.EventTarget;M=a.Node;N=x.JS=x.JS||{};O=f.DomUtility=f.DomUtility||{};P=a.Object;Q=z.DictionaryUtil=z.DictionaryUtil||{};R=d.Enumerator=d.Enumerator||{};S=R.T=R.T||{};T=f.AttrProxy=f.AttrProxy||{};U=f.CheckedInput=f.CheckedInput||{};V=d.Numeric=d.Numeric||{};W=f.Attrs=f.Attrs||{};X=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};Y=a.WindowOrWorkerGlobalScope;Z=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};_0=f.Docs=f.Docs||{};_1=f.DynamicAttrNode=f.DynamicAttrNode||{};_2=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};_3=v.Prepare=v.Prepare||{};_4=d.Slice=d.Slice||{};_5=z.KeyCollection=z.KeyCollection||{};_6=f.DocElemNode=f.DocElemNode||{};_7=a.CharacterData;_8=f.An=f.An||{};_9=u.Settings=u.Settings||{};_=J.Mailbox=J.Mailbox||{};$=f.Elt=f.Elt||{};ba=f.Array=f.Array||{};bb=z.HashSetUtil=z.HashSetUtil||{};bc=d.Strings=d.Strings||{};bd=u.Attrs=u.Attrs||{};be=bd.Dyn=bd.Dyn||{};bf=u.Docs=u.Docs||{};bg=bf.RunState=bf.RunState||{};bh=bf.NodeSet=bf.NodeSet||{};bi=f.Anims=f.Anims||{};bj=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};bk=f.Updates=f.Updates||{};bl=d.List=d.List||{};bm=bl.T=bl.T||{};bn=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};bo=d.Concurrency=d.Concurrency||{};bp=f.AppendList=f.AppendList||{};bq=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};br=d.Queue=d.Queue||{};bs=f.Easing=f.Easing||{};bt=bo.AsyncBody=bo.AsyncBody||{};bu=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};bv=bo.CT=bo.CT||{};bw=J.HashSet=J.HashSet||{};bx=f.String=f.String||{};by=bo.Scheduler=bo.Scheduler||{};bz=d.CancellationTokenSource=d.CancellationTokenSource||{};bA=bf.DomNodes=bf.DomNodes||{};bB=d.Char=d.Char||{};bC=a.Error;bD=d.OperationCanceledException=d.OperationCanceledException||{};bE=d.Lazy=d.Lazy||{};bF=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};bG=d.LazyExtensionsProxy=d.LazyExtensionsProxy||{};bH=bG.LazyRecord=bG.LazyRecord||{};bI=a.MathJax;bJ=bI&&bI.Hub;bK=a.IntelliFactory;bL=bK&&bK.Runtime;bM=a.jQuery;bN=a.console;bO=a.Math;bP=a.Date;c.Main=function(){var bQ,bR,bS,bT,bU,bV,bW,bX,bY;function bZ(b0,b1){var b2;b2=a.jQuery("#tex div").empty();b2.append.apply(b2,["$$"+b1+"$$"]);bJ.Queue([["Typeset",bJ,[b0]]]);}bJ.Config((bQ={},bQ.extensions=["tex2jax.js"],bQ.jax=["input/TeX","output/HTML-CSS"],bQ.tex2jax=(bR={},bR.inlineMath=[["$","$"],["\\(","\\)"]],bR),bQ));bS=g.Create$1("\\frac{2\\cdot x\\cdot\\left({ x}^{9}+{ x}^{2}\\right)-{ x}^{2}\\cdot\\left(9\\cdot{ x}^{8}+2\\cdot x\\right)}{{\\left({ x}^{9}+{ x}^{2}\\right)}^{2}}+2\\cdot{ x}^{3}");bT=bS.get_View();bU=w.Element("div",[I.DynamicCustom(function(b0){return function(b1){return bZ(b0,b1);};},bT)],[w.TextView(r.Map(function(b0){return"$$"+b0+"$$";},bT))]);v.LoadLocalTemplates("");w.RunById("tex",bU);bV=(bW=o.Make().WithHole({$:8,$0:"expression",$1:bS}),(bX=p.CompleteHoles(bW.k,bW.h,[["expression",0]]),(bY=new m.New(bX[1],q.main(bX[0])),(bW.i=bY,bY)))).get_Doc();v.LoadLocalTemplates("");w.RunById("main",bV);};e=d.Obj=bL.Class({Equals:function(bQ){return this===bQ;},GetHashCode:function(){return -1;}},null,e);e.New=bL.Ctor(function(){},e);g=f.Var$1=bL.Class({},e,g);g.Create$1=function(bQ){return new s.New(false,t.New({$:2,$0:bQ,$1:[]}),bQ);};h=f.Var=bL.Class({},e,h);h.New=bL.Ctor(function(){e.New.call(this);},h);i.FailWith=function(bQ){throw new bC(bQ);};i.KeyValue=function(bQ){return[bQ.K,bQ.V];};m=l.TemplateInstance=bL.Class({get_Doc:function(){return this.doc;}},e,m);m.New=bL.Ctor(function(bQ,bR){e.New.call(this);this.doc=bR;this.allVars=bQ.$==0?bQ.$0:i.FailWith("Should not happen");},m);n.get=function(bQ,bR){n.checkBounds(bQ,bR);return bQ[bR];};n.checkBounds=function(bQ,bR){if(bR<0||bR>=bQ.length)i.FailWith("Index was outside the bounds of the array.");};n.length=function(bQ){return bQ.dims===2?bQ.length*bQ.length:bQ.length;};n.set=function(bQ,bR,bS){n.checkBounds(bQ,bR);bQ[bR]=bS;};o=l.ProviderBuilder=bL.Class({WithHole:function(bQ){this.h.push(bQ);return this;}},null,o);o.Make=function(){var bQ;return o.New(null,(bQ=D.NewGuid(),a.String(bQ)),[]);};o.New=function(bQ,bR,bS){return new o({i:bQ,k:bR,h:bS});};p.CompleteHoles=function(bQ,bR,bS){var bU,bV,bW,bX,bY,bZ;function bT(b0,b1){var b2,b3,b4,b5;return bV.Contains(b0)?null:(b2=b1===0?(b3=g.Create$1(""),[{$:8,$0:b0,$1:b3},b3]):b1===1?(b4=g.Create$1(0),[{$:13,$0:b0,$1:b4},b4]):b1===2?(b5=g.Create$1(false),[{$:9,$0:b0,$1:b5},b5]):i.FailWith("Invalid value type"),(bU.set_Item(b0,b2[1]),{$:1,$0:b2[0]}));}bU=new E.New$5();bV=new F.New$3();bW=R.Get(bR);try{while(bW.MoveNext()){bX=bW.Current();(bX.$==8?(bY=[bX.$0,G.Box(bX.$1)],true):bX.$==11?(bY=[bX.$0,G.Box(bX.$1)],true):bX.$==10?(bY=[bX.$0,G.Box(bX.$1)],true):bX.$==13?(bY=[bX.$0,G.Box(bX.$1)],true):bX.$==12?(bY=[bX.$0,G.Box(bX.$1)],true):bX.$==9&&(bY=[bX.$0,G.Box(bX.$1)],true))?(bZ=bY[0],bV.Add(bZ),bU.set_Item(bZ,bY[1])):void 0;}}finally{if(typeof bW=="object"&&"Dispose"in bW)bW.Dispose();}return[H.append(bR,n.choose(function(b0){return bT(b0[0],b0[1]);},bS)),{$:0,$0:bU}];};q.main=function(bQ){return bQ?v.GetOrLoadTemplate("index",{$:1,$0:"main"},function(){return bM.parseHTML("\n            <div class=\"mdl-textfield mdl-js-textfield mdl-textfield--floating-label\">\n                <input class=\"mdl-textfield__input\" type=\"text\" id=\"expression\" ws-var=\"Expression\" value=\"\\frac{2\\cdot x\\cdot\\left({ x}^{9}+{ x}^{2}\\right)-{ x}^{2}\\cdot\\left(9\\cdot{ x}^{8}+2\\cdot x\\right)}{{\\left({ x}^{9}+{ x}^{2}\\right)}^{2}}+2\\cdot{ x}^{3}\">\n                <label class=\"mdl-textfield__label\" for=\"expression\">TeX Expression</label>\n            </div>\n        ");},bQ):v.PrepareTemplate("index",{$:1,$0:"main"},function(){return bM.parseHTML("\n            <div class=\"mdl-textfield mdl-js-textfield mdl-textfield--floating-label\">\n                <input class=\"mdl-textfield__input\" type=\"text\" id=\"expression\" ws-var=\"Expression\" value=\"\\frac{2\\cdot x\\cdot\\left({ x}^{9}+{ x}^{2}\\right)-{ x}^{2}\\cdot\\left(9\\cdot{ x}^{8}+2\\cdot x\\right)}{{\\left({ x}^{9}+{ x}^{2}\\right)}^{2}}+2\\cdot{ x}^{3}\">\n                <label class=\"mdl-textfield__label\" for=\"expression\">TeX Expression</label>\n            </div>\n        ");});};r=f.View=bL.Class({},null,r);s=f.ConcreteVar=bL.Class({get_View:function(){return this.view;},Get:function(){return this.current;},Set:function(bQ){if(this.isConst)(function(bR){return bR("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(bR){bN.log(bR);}));else{t.Obsolete(this.snap);this.current=bQ;this.snap=t.New({$:2,$0:bQ,$1:[]});}},UpdateMaybe:function(bQ){var bR;bR=bQ(this.Get());bR!=null&&bR.$==1?this.Set(bR.$0):void 0;}},h,s);s.New=bL.Ctor(function(bQ,bR,bS){var bT;bT=this;h.New.call(this);this.isConst=bQ;this.current=bS;this.snap=bR;this.view=function(){return bT.snap;};this.id=K.Int();},s);t.Map=function(bQ,bR){var bS,bT;bS=bR.s;return bS!=null&&bS.$==0?t.New({$:0,$0:bQ(bS.$0)}):(bT=t.New({$:3,$0:[],$1:[]}),(t.When(bR,function(bU){t.MarkDone(bT,bR,bQ(bU));},bT),bT));};t.WhenObsoleteRun=function(bQ,bR){var bS;bS=bQ.s;bS==null?bR():bS!=null&&bS.$==2?bS.$1.push(bR):bS!=null&&bS.$==3?bS.$1.push(bR):void 0;};t.When=function(bQ,bR,bS){var bT;bT=bQ.s;bT==null?t.Obsolete(bS):bT!=null&&bT.$==2?(t.EnqueueSafe(bT.$1,bS),bR(bT.$0)):bT!=null&&bT.$==3?(bT.$0.push(bR),t.EnqueueSafe(bT.$1,bS)):bR(bT.$0);};t.MarkDone=function(bQ,bR,bS){var bT;if(bT=bR.s,bT!=null&&bT.$==0)t.MarkForever(bQ,bS);else t.MarkReady(bQ,bS);};t.EnqueueSafe=function(bQ,bR){var bS,bT,bU,bV;bQ.push(bR);if(bQ.length%20===0){bS=bQ.slice(0);br.Clear(bQ);for(bT=0,bU=n.length(bS)-1;bT<=bU;bT++){bV=n.get(bS,bT);typeof bV=="object"?function(bW){if(bW.s)bQ.push(bW);}(bV):function(bW){bQ.push(bW);}(bV);}}else void 0;};t.MarkForever=function(bQ,bR){var bS,bT,bU,bV;bS=bQ.s;if(bS!=null&&bS.$==3){bQ.s={$:0,$0:bR};bT=bS.$0;for(bU=0,bV=n.length(bT)-1;bU<=bV;bU++)(n.get(bT,bU))(bR);}else void 0;};t.MarkReady=function(bQ,bR){var bS,bT,bU,bV;bS=bQ.s;if(bS!=null&&bS.$==3){bQ.s={$:2,$0:bR,$1:bS.$1};bT=bS.$0;for(bU=0,bV=n.length(bT)-1;bU<=bV;bU++)(n.get(bT,bU))(bR);}else void 0;};t.WhenRun=function(bQ,bR,bS){var bT;bT=bQ.s;bT==null?bS():bT!=null&&bT.$==2?(bT.$1.push(bS),bR(bT.$0)):bT!=null&&bT.$==3?(bT.$0.push(bR),bT.$1.push(bS)):bR(bT.$0);};t.Copy=function(bQ){var bR,bS,bT;bR=bQ.s;return bR==null?bQ:bR!=null&&bR.$==2?(bS=t.New({$:2,$0:bR.$0,$1:[]}),(t.WhenObsolete(bQ,bS),bS)):bR!=null&&bR.$==3?(bT=t.New({$:3,$0:[],$1:[]}),(t.When(bQ,function(bU){t.MarkDone(bT,bQ,bU);},bT),bT)):bQ;};t.Map2Unit=function(bQ,bR){var bS,bT,bU;function bV(){var bW,bX,bY;if(!(bW=bU.s,bW!=null&&bW.$==0||bW!=null&&bW.$==2)){bX=t.ValueAndForever(bQ);bY=t.ValueAndForever(bR);bX!=null&&bX.$==1?bY!=null&&bY.$==1?bX.$0[1]&&bY.$0[1]?t.MarkForever(bU,null):t.MarkReady(bU,null):void 0:void 0;}}bS=bQ.s;bT=bR.s;return bS!=null&&bS.$==0?bT!=null&&bT.$==0?t.New({$:0,$0:null}):bR:bT!=null&&bT.$==0?bQ:(bU=t.New({$:3,$0:[],$1:[]}),(t.When(bQ,bV,bU),t.When(bR,bV,bU),bU));};t.Map3=function(bQ,bR,bS,bT){var bU,bV,bW,bX;function bY(bZ){var b0,b1,b2,b3;if(!(b0=bX.s,b0!=null&&b0.$==0||b0!=null&&b0.$==2)){b1=t.ValueAndForever(bR);b2=t.ValueAndForever(bS);b3=t.ValueAndForever(bT);b1!=null&&b1.$==1?b2!=null&&b2.$==1?b3!=null&&b3.$==1?b1.$0[1]&&b2.$0[1]&&b3.$0[1]?t.MarkForever(bX,bQ(b1.$0[0],b2.$0[0],b3.$0[0])):t.MarkReady(bX,bQ(b1.$0[0],b2.$0[0],b3.$0[0])):void 0:void 0:void 0;}}bU=bR.s;bV=bS.s;bW=bT.s;return bU!=null&&bU.$==0?bV!=null&&bV.$==0?bW!=null&&bW.$==0?t.New({$:0,$0:bQ(bU.$0,bV.$0,bW.$0)}):t.Map3Opt1(bQ,bU.$0,bV.$0,bT):bW!=null&&bW.$==0?t.Map3Opt2(bQ,bU.$0,bW.$0,bS):t.Map3Opt3(bQ,bU.$0,bS,bT):bV!=null&&bV.$==0?bW!=null&&bW.$==0?t.Map3Opt4(bQ,bV.$0,bW.$0,bR):t.Map3Opt5(bQ,bV.$0,bR,bT):bW!=null&&bW.$==0?t.Map3Opt6(bQ,bW.$0,bR,bS):(bX=t.New({$:3,$0:[],$1:[]}),(t.When(bR,bY,bX),t.When(bS,bY,bX),t.When(bT,bY,bX),bX));};t.Sequence=function(bQ){var bR,bS,bT;function bU(bV){var bW;if(bT[0]===0){bW=n.map(function(bX){var bY;bY=bX.s;return bY!=null&&bY.$==0?bY.$0:bY!=null&&bY.$==2?bY.$0:i.FailWith("value not found by View.Sequence");},bR);n.forall(function(bX){var bY;bY=bX.s;return bY!=null&&bY.$==0;},bR)?t.MarkForever(bS,bW):t.MarkReady(bS,bW);}else bT[0]--;}bR=n.ofSeq(bQ);return bR.length==0?t.New({$:0,$0:[]}):(bS=t.New({$:3,$0:[],$1:[]}),(bT=[n.length(bR)-1],(n.iter(function(bV){t.When(bV,bU,bS);},bR),bS)));};t.Map2=function(bQ,bR,bS){var bT,bU,bV;function bW(bX){var bY,bZ,b0;if(!(bY=bV.s,bY!=null&&bY.$==0||bY!=null&&bY.$==2)){bZ=t.ValueAndForever(bR);b0=t.ValueAndForever(bS);bZ!=null&&bZ.$==1?b0!=null&&b0.$==1?bZ.$0[1]&&b0.$0[1]?t.MarkForever(bV,bQ(bZ.$0[0],b0.$0[0])):t.MarkReady(bV,bQ(bZ.$0[0],b0.$0[0])):void 0:void 0;}}bT=bR.s;bU=bS.s;return bT!=null&&bT.$==0?bU!=null&&bU.$==0?t.New({$:0,$0:bQ(bT.$0,bU.$0)}):t.Map2Opt1(bQ,bT.$0,bS):bU!=null&&bU.$==0?t.Map2Opt2(bQ,bU.$0,bR):(bV=t.New({$:3,$0:[],$1:[]}),(t.When(bR,bW,bV),t.When(bS,bW,bV),bV));};t.WhenObsolete=function(bQ,bR){var bS;bS=bQ.s;bS==null?t.Obsolete(bR):bS!=null&&bS.$==2?t.EnqueueSafe(bS.$1,bR):bS!=null&&bS.$==3?t.EnqueueSafe(bS.$1,bR):void 0;};t.ValueAndForever=function(bQ){var bR;bR=bQ.s;return bR!=null&&bR.$==0?{$:1,$0:[bR.$0,true]}:bR!=null&&bR.$==2?{$:1,$0:[bR.$0,false]}:null;};t.Map3Opt1=function(bQ,bR,bS,bT){return t.Map(function(bU){return bQ(bR,bS,bU);},bT);};t.Map3Opt2=function(bQ,bR,bS,bT){return t.Map(function(bU){return bQ(bR,bU,bS);},bT);};t.Map3Opt3=function(bQ,bR,bS,bT){return t.Map2(function(bU,bV){return bQ(bR,bU,bV);},bS,bT);};t.Map3Opt4=function(bQ,bR,bS,bT){return t.Map(function(bU){return bQ(bU,bR,bS);},bT);};t.Map3Opt5=function(bQ,bR,bS,bT){return t.Map2(function(bU,bV){return bQ(bU,bR,bV);},bS,bT);};t.Map3Opt6=function(bQ,bR,bS,bT){return t.Map2(function(bU,bV){return bQ(bU,bV,bR);},bS,bT);};t.Map2Opt1=function(bQ,bR,bS){return t.Map(function(bT){return bQ(bR,bT);},bS);};t.Map2Opt2=function(bQ,bR,bS){return t.Map(function(bT){return bQ(bT,bR);},bS);};v.LoadLocalTemplates=function(bQ){!v.LocalTemplatesLoaded()?(v.set_LocalTemplatesLoaded(true),v.LoadNestedTemplates(self.document.body,"")):void 0;v.LoadedTemplates().set_Item(bQ,v.LoadedTemplateFile(""));};v.LocalTemplatesLoaded=function(){X.$cctor();return X.LocalTemplatesLoaded;};v.set_LocalTemplatesLoaded=function(bQ){X.$cctor();X.LocalTemplatesLoaded=bQ;};v.LoadNestedTemplates=function(bQ,bR){var bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6;function bS(b7){var b8,b9;if(!bT.ContainsKey(b7)){b8=(b9=null,[bU.TryGetValue(b7,{get:function(){return b9;},set:function(b_){b9=b_;}}),b9]);b8[0]?(b6.Add(b7),bU.Remove(b7),v.PrepareTemplateStrict(bR,{$:1,$0:b7},b8[1][0],{$:1,$0:b8[1][1]},{$:1,$0:bS})):bN.warn(b6.Contains(b7)?"Encountered loop when instantiating "+b7:"Local template does not exist: "+b7);}}bT=v.LoadedTemplateFile(bR);bU=new E.New$5();bV=bQ.querySelectorAll("[ws-template]");for(bW=0,bX=bV.length-1;bW<=bX;bW++){bY=bV[bW];bZ=bY.getAttribute("ws-template").toLowerCase();bY.removeAttribute("ws-template");bU.set_Item(bZ,[[bY],v.FakeRootSingle(bY)]);}b0=bQ.querySelectorAll("[ws-children-template]");for(b1=0,b2=b0.length-1;b1<=b2;b1++){b3=b0[b1];b4=b3.getAttribute("ws-children-template").toLowerCase();b3.removeAttribute("ws-children-template");bU.set_Item(b4,(b5=O.ChildrenArray(b3),[b5,v.FakeRoot(b5)]));}b6=new F.New$3();while(bU.count>0)bS(H.head(bU.get_Keys()));};v.LoadedTemplates=function(){X.$cctor();return X.LoadedTemplates;};v.LoadedTemplateFile=function(bQ){var bR,bS,bT;bR=(bS=null,[v.LoadedTemplates().TryGetValue(bQ,{get:function(){return bS;},set:function(bU){bS=bU;}}),bS]);return bR[0]?bR[1]:(bT=new E.New$5(),(v.LoadedTemplates().set_Item(bQ,bT),bT));};v.GetOrLoadTemplate=function(bQ,bR,bS,bT){v.LoadLocalTemplates("");v.PrepareTemplate(bQ,bR,bS);return v.NamedTemplate(bQ,bR,bT);};v.PrepareTemplate=function(bQ,bR,bS){var bT,bU,bV,bW,bX;if(!v.LoadedTemplateFile(bQ).ContainsKey(bR==null?"":bR.$0)){bT=bS();for(bU=0,bV=bT.length-1;bU<=bV;bU++){bW=n.get(bT,bU);bX=bW.parentNode;B.Equals(bX,null)?void 0:bX.removeChild(bW);}v.PrepareTemplateStrict(bQ,bR,bT,null,null);}};v.FakeRootSingle=function(bQ){var bR,bS,bT;bQ.removeAttribute("ws-template");bR=bQ.getAttribute("ws-replace");bR===null?void 0:(bQ.removeAttribute("ws-replace"),bS=bQ.parentNode,B.Equals(bS,null)?void 0:(bT=self.document.createElement(bQ.tagName),bT.setAttribute("ws-replace",bR),bS.replaceChild(bT,bQ)));return v.FakeRoot([bQ]);};v.FakeRoot=function(bQ){var bR,bS,bT;bR=self.document.createElement("div");for(bS=0,bT=bQ.length-1;bS<=bT;bS++)bR.appendChild(n.get(bQ,bS));return bR;};v.PrepareTemplateStrict=function(bQ,bR,bS,bT,bU){var bV,bW;function bX(b2,b3){var b4,b5,b6,b7,b8,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs;function b9(ct){}while(true)switch(b2){case 0:if(b3!==null){b4=b3.nextSibling;if(B.Equals(b3.nodeType,M.TEXT_NODE))_3.convertTextNode(b3);else if(B.Equals(b3.nodeType,M.ELEMENT_NODE))bZ(b3);b3=b4;}else return null;break;case 1:b_=_4.string(b3.nodeName,{$:1,$0:3},null).toLowerCase();b$=(b5=b_.indexOf("."),b5===-1?[bQ,b_]:[_4.string(b_,null,{$:1,$0:b5-1}),_4.string(b_,{$:1,$0:b5+1},null)]);ca=b$[1];cb=b$[0];if(cb!==""&&!v.LoadedTemplates().ContainsKey(cb))return _3.failNotLoaded(ca);else{if(cb===""&&bU!=null)bU.$0(ca);cc=v.LoadedTemplates().get_Item(cb);if(!cc.ContainsKey(ca))return _3.failNotLoaded(ca);else{cd=cc.get_Item(ca);ce=cd.cloneNode(true);cf=new F.New$3();cg=new E.New$5();ch=b3.attributes;for(ci=0,cj=ch.length-1;ci<=cj;ci++){ck=ch.item(ci).name.toLowerCase();cg.set_Item(ck,(cl=ch.item(ci).nodeValue,cl===""?ck:cl.toLowerCase()));!cf.Add(ck)?bN.warn("Hole mapped twice",ck):void 0;}for(cm=0,cn=b3.childNodes.length-1;cm<=cn;cm++){co=b3.childNodes[cm];B.Equals(co.nodeType,M.ELEMENT_NODE)?!cf.Add(co.nodeName.toLowerCase())?bN.warn("Hole filled twice",ca):void 0:void 0;}cp=b3.childNodes.length===1&&B.Equals(b3.firstChild.nodeType,M.TEXT_NODE);if(cp){b7=_3.fillTextHole(ce,b3.firstChild.textContent,ca);((function(ct){return function(cu){if(cu!=null)ct(cu.$0);};}((b8=function(ct){return function(cu){return ct.Add(cu);};}(cf),function(ct){return b9(b8(ct));})))(b7));}_3.removeHolesExcept(ce,cf);if(!cp){for(cq=0,cr=b3.childNodes.length-1;cq<=cr;cq++){cs=b3.childNodes[cq];B.Equals(cs.nodeType,M.ELEMENT_NODE)?cs.hasAttributes()?_3.fillInstanceAttrs(ce,cs):bY(ce,cs):void 0;}}_3.mapHoles(ce,cg);_3.fill(ce,b3.parentNode,b3);b3.parentNode.removeChild(b3);return;}}break;}}function bY(b2,b3){var b4,b6,b7;function b5(b8,b9){var b_,b$,ca;if(b6==="title"&&b3.hasChildNodes()){b_=bM.parseHTML(b3.textContent);b3.removeChild(b3.firstChild);for(b$=0,ca=b_.length-1;b$<=ca;b$++)b3.appendChild(n.get(b_,b$));}else null;bZ(b3);return _3.fill(b3,b8,b9);}b6=b3.nodeName.toLowerCase();O.IterSelector(b2,"[ws-attr-holes]",function(b8){var b9,b_,b$,ca,cb;b9=bc.SplitChars(b8.getAttribute("ws-attr-holes"),[" "],1);for(b_=0,b$=b9.length-1;b_<=b$;b_++){ca=n.get(b9,b_);b8.setAttribute(ca,(cb=new a.RegExp("\\${"+b6+"}","ig"),b8.getAttribute(ca).replace(cb,b3.textContent)));}});b7=b2.querySelector("[ws-hole="+b6+"]");if(B.Equals(b7,null)){b4=b2.querySelector("[ws-replace="+b6+"]");return B.Equals(b4,null)?null:(b5(b4.parentNode,b4),void b4.parentNode.removeChild(b4));}else{while(b7.hasChildNodes())b7.removeChild(b7.lastChild);b7.removeAttribute("ws-hole");return b5(b7,null);}}function bZ(b2){if(bc.StartsWith(b2.nodeName.toLowerCase(),"ws-"))b1(b2);else{_3.convertAttrs(b2);b0(b2.firstChild);}}function b0(b2){return bX(0,b2);}function b1(b2){return bX(1,b2);}bV=bT==null?v.FakeRoot(bS):bT.$0;bW=(bR==null?"":bR.$0).toLowerCase();v.LoadedTemplateFile(bQ).set_Item(bW,bV);n.length(bS)>0?(function(b2){var b3,b4,b5,b6;while(true){b3=b2.querySelector("[ws-template]");if(B.Equals(b3,null)){b4=b2.querySelector("[ws-children-template]");if(B.Equals(b4,null))return null;else{b5=b4.getAttribute("ws-children-template");b4.removeAttribute("ws-children-template");v.PrepareTemplateStrict(bQ,{$:1,$0:b5},O.ChildrenArray(b4),null,null);b2=b2;}}else{b6=b3.getAttribute("ws-template");(v.PrepareSingleTemplate(bQ,{$:1,$0:b6},b3))(null);b2=b2;}}}(bV),b0(n.get(bS,0))):void 0;};v.NamedTemplate=function(bQ,bR,bS){var bT,bU;bT=(bU=null,[v.LoadedTemplateFile(bQ).TryGetValue(bR==null?"":bR.$0,{get:function(){return bU;},set:function(bV){bU=bV;}}),bU]);return bT[0]?v.ChildrenTemplate(bT[1].cloneNode(true),bS):(bN.warn("Local template doesn't exist",bR),w.get_Empty());};v.PrepareSingleTemplate=function(bQ,bR,bS){var bT,bU,bV;bT=v.FakeRootSingle(bS);bU=[bS];bV={$:1,$0:bT};return function(bW){v.PrepareTemplateStrict(bQ,bR,bU,bV,bW);};};v.ChildrenTemplate=function(bQ,bR){var bS,bT,bU,bV,bW;bS=v.InlineTemplate(bQ,bR);bT=bS[1];bU=bS[0];bV=bU.Els;return!B.Equals(bV,null)&&bV.length===1&&(n.get(bV,0)instanceof M&&(B.Equals(n.get(bV,0).nodeType,M.ELEMENT_NODE)&&(bW=n.get(bV,0),true)))?$.TreeNode(bU,bT):w.Mk({$:6,$0:bU},bT);};v.TextHoleRE=function(){X.$cctor();return X.TextHoleRE;};v.InlineTemplate=function(bQ,bR){var bS,bT,bU,bV,bY,bZ,b0,b1,b2,b3,b4;function bW(b5,b6){var b7,b8,b9;b7=W.Insert(b5,b6);bZ.push(W.Updates(b7));b0.push([b5,b7]);b8=bL.GetOptional(b7.OnAfterRender);return b8==null?null:(b9=b8.$0,void b1.push(function(){b9(b5);}));}function bX(b5){var b6,b7;b6=(b7=null,[b2.TryGetValue(b5,{get:function(){return b7;},set:function(b8){b7=b8;}}),b7]);return b6[0]?b6[1].$==0?{$:1,$0:b6[1].$1}:b6[1].$==1?{$:1,$0:w.TextNode(b6[1].$1)}:b6[1].$==2?{$:1,$0:w.TextView(b6[1].$1)}:b6[1].$==8?{$:1,$0:w.TextView(b6[1].$1.get_View())}:b6[1].$==9?{$:1,$0:w.TextView(r.Map(a.String,b6[1].$1.get_View()))}:b6[1].$==10?{$:1,$0:w.TextView(r.Map(function(b8){return b8.get_Input();},b6[1].$1.get_View()))}:b6[1].$==11?{$:1,$0:w.TextView(r.Map(a.String,b6[1].$1.get_View()))}:b6[1].$==12?{$:1,$0:w.TextView(r.Map(function(b8){return b8.get_Input();},b6[1].$1.get_View()))}:b6[1].$==13?{$:1,$0:w.TextView(r.Map(a.String,b6[1].$1.get_View()))}:(bN.warn("Content hole filled with attribute data",b5),null):null;}bY=[];bZ=[];b0=[];b1=[];b2=new E.New$5();b3=R.Get(bR);try{while(b3.MoveNext()){b4=b3.Current();b2.set_Item(b4.$0,b4);}}finally{if(typeof b3=="object"&&"Dispose"in b3)b3.Dispose();}bS=O.ChildrenArray(bQ);O.IterSelector(bQ,"[ws-hole]",function(b5){var b6,b7,b8;b8=b5.getAttribute("ws-hole");b5.removeAttribute("ws-hole");while(b5.hasChildNodes())b5.removeChild(b5.lastChild);b6=bX(b8);b6!=null&&b6.$==1?(b7=b6.$0,_0.LinkElement(b5,b7.docNode),bY.push(_6.New(W.Empty(b5),b7.docNode,null,b5,K.Int(),null)),bZ.push(b7.updates)):void 0;});O.IterSelector(bQ,"[ws-replace]",function(b5){var b6,b7,b8,b9,b_,b$;b6=bX(b5.getAttribute("ws-replace"));b6!=null&&b6.$==1?(b7=b6.$0,b8=b5.parentNode,b9=self.document.createTextNode(""),b8.replaceChild(b9,b5),b_=_0.InsertBeforeDelim(b9,b7.docNode),b$=n.tryFindIndex(function(ca){return b5===ca;},bS),b$==null?void 0:n.set(bS,b$.$0,b7.docNode),bY.push(_6.New(W.Empty(b8),b7.docNode,{$:1,$0:[b_,b9]},b8,K.Int(),null)),bZ.push(b7.updates)):void 0;});O.IterSelector(bQ,"[ws-attr]",function(b5){var b6,b7,b8;b6=b5.getAttribute("ws-attr");b5.removeAttribute("ws-attr");b7=(b8=null,[b2.TryGetValue(b6,{get:function(){return b8;},set:function(b9){b8=b9;}}),b8]);b7[0]?b7[1].$==3?bW(b5,b7[1].$1):bN.warn("Attribute hole filled with non-attribute data",b6):void 0;});O.IterSelector(bQ,"[ws-on]",function(b5){bW(b5,T.Concat(n.choose(function(b6){var b7,b8,b9;b7=bc.SplitChars(b6,[":"],1);b8=(b9=null,[b2.TryGetValue(n.get(b7,1),{get:function(){return b9;},set:function(b_){b9=b_;}}),b9]);return b8[0]?b8[1].$==4?{$:1,$0:I.Handler(n.get(b7,0),b8[1].$1)}:b8[1].$==5?{$:1,$0:T.Handler(n.get(b7,0),b8[1].$2)}:(bN.warn("Event hole on"+n.get(b7,0)+" filled with non-event data",n.get(b7,1)),null):null;},bc.SplitChars(b5.getAttribute("ws-on"),[" "],1))));b5.removeAttribute("ws-on");});O.IterSelector(bQ,"[ws-onafterrender]",function(b5){var b6,b7,b8;b6=b5.getAttribute("ws-onafterrender");b7=(b8=null,[b2.TryGetValue(b6,{get:function(){return b8;},set:function(b9){b8=b9;}}),b8]);b7[0]?b7[1].$==6?(b5.removeAttribute("ws-onafterrender"),bW(b5,I.OnAfterRender(b7[1].$1))):b7[1].$==7?(b5.removeAttribute("ws-onafterrender"),bW(b5,I.OnAfterRender(b7[1].$1))):bN.warn("onafterrender hole filled with non-onafterrender data",b6):void 0;});O.IterSelector(bQ,"[ws-var]",function(b5){var b6,b7,b8;b6=b5.getAttribute("ws-var");b5.removeAttribute("ws-var");b7=(b8=null,[b2.TryGetValue(b6,{get:function(){return b8;},set:function(b9){b8=b9;}}),b8]);b7[0]?b7[1].$==8?bW(b5,I.Value(b7[1].$1)):b7[1].$==9?bW(b5,I.Checked(b7[1].$1)):b7[1].$==10?bW(b5,I.IntValue(b7[1].$1)):b7[1].$==11?bW(b5,I.IntValueUnchecked(b7[1].$1)):b7[1].$==12?bW(b5,I.FloatValue(b7[1].$1)):b7[1].$==13?bW(b5,I.FloatValueUnchecked(b7[1].$1)):bN.warn("Var hole filled with non-Var data",b6):void 0;});O.IterSelector(bQ,"[ws-attr-holes]",function(b5){var b6,b7,b8,b9;b6=new a.RegExp(v.TextHoleRE(),"g");b7=bc.SplitChars(b5.getAttribute("ws-attr-holes"),[" "],1);b5.removeAttribute("ws-attr-holes");for(b8=0,b9=b7.length-1;b8<=b9;b8++)(function(){var b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck;ch=n.get(b7,b8);ci=b5.getAttribute(ch);b_=null;b$=0;cj=[];while(b_=b6.exec(ci),b_!==null){ck=_4.string(ci,{$:1,$0:b$},{$:1,$0:b6.lastIndex-n.get(b_,0).length-1});b$=b6.lastIndex;cj.push([ck,n.get(b_,1)]);}cb=_4.string(ci,{$:1,$0:b$},null);b6.lastIndex=0;cc=n.foldBack(function(cl,cm){return(function(cn){var co,cp;co=cn[0];cp=cn[1];return function(cq){var cr,cs,ct,cu,cv;cr=cq[0];cs=cq[1];ct=(cu=(cv=null,[b2.TryGetValue(cp,{get:function(){return cv;},set:function(cw){cv=cw;}}),cv]),cu[0]?cu[1].$==1?{$:0,$0:cu[1].$1}:cu[1].$==2?{$:1,$0:cu[1].$1}:cu[1].$==8?{$:1,$0:cu[1].$1.get_View()}:cu[1].$==9?{$:1,$0:r.Map(a.String,cu[1].$1.get_View())}:cu[1].$==10?{$:1,$0:r.Map(function(cw){return cw.get_Input();},cu[1].$1.get_View())}:cu[1].$==11?{$:1,$0:r.Map(a.String,cu[1].$1.get_View())}:cu[1].$==12?{$:1,$0:r.Map(function(cw){return cw.get_Input();},cu[1].$1.get_View())}:cu[1].$==13?{$:1,$0:r.Map(a.String,cu[1].$1.get_View())}:(bN.warn("Attribute value hole filled with non-text data",cp),{$:0,$0:""}):{$:0,$0:""});return ct.$==1?[co,new bm({$:1,$0:cr===""?ct.$0:r.Map(function(cw){return cw+cr;},ct.$0),$1:cs})]:[co+ct.$0+cr,cs];};}(cl))(cm);},cj,[cb,bm.Empty]);return bW(b5,cc[1].$==1?cc[1].$1.$==1?cc[1].$1.$1.$==1?cc[1].$1.$1.$1.$==0?(cd=cc[0],I.Dynamic(ch,r.Map3(function(cl,cm,cn){return cd+cl+cm+cn;},cc[1].$0,cc[1].$1.$0,cc[1].$1.$1.$0))):(ce=cc[0],I.Dynamic(ch,r.Map(function(cl){return ce+bc.concat("",cl);},r.Sequence(cc[1])))):(cf=cc[0],I.Dynamic(ch,r.Map2(function(cl,cm){return cf+cl+cm;},cc[1].$0,cc[1].$1.$0))):cc[0]===""?I.Dynamic(ch,cc[1].$0):(cg=cc[0],I.Dynamic(ch,r.Map(function(cl){return cg+cl;},cc[1].$0))):T.Create(ch,cc[0]));}());});return[bL.DeleteEmptyFields({Els:bS,Dirty:true,Holes:bY,Attrs:b0,Render:(bT=b1.length==0?null:{$:1,$0:function(b5){n.iter(function(b6){b6(b5);},b1);}},bT?bT.$0:void 0),El:(bU=!B.Equals(bS,null)&&bS.length===1&&(n.get(bS,0)instanceof M&&(n.get(bS,0)instanceof a.Element&&(bV=n.get(bS,0),true)))?{$:1,$0:bV}:null,bU?bU.$0:void 0)},["Render","El"]),ba.TreeReduce(r.Const(),r.Map2Unit,bZ)];};w=f.Doc=bL.Class({},e,w);w.RunById=function(bQ,bR){var bS;bS=O.Doc().getElementById(bQ);B.Equals(bS,null)?i.FailWith("invalid id: "+bQ):w.Run(bS,bR);};w.Run=function(bQ,bR){_0.LinkElement(bQ,bR.docNode);w.RunInPlace(false,bQ,bR);};w.Element=function(bQ,bR,bS){var bT,bU;bT=T.Concat(bR);bU=w.Concat(bS);return $.New(O.CreateElement(bQ),bT,bU);};w.TextView=function(bQ){var bR;bR=_0.CreateTextNode();return w.Mk({$:4,$0:bR},r.Map(function(bS){_0.UpdateTextNode(bR,bS);},bQ));};w.RunInPlace=function(bQ,bR,bS){var bT;bT=_0.CreateRunState(bR,bS.docNode);r.Sink(_8.get_UseAnimations()||_9.BatchUpdatesEnabled()?_.StartProcessor(_0.PerformAnimatedUpdate(bQ,bT,bS.docNode)):function(){_0.PerformSyncUpdate(bQ,bT,bS.docNode);},bS.updates);};w.Concat=function(bQ){var bR;bR=ba.ofSeqNonCopying(bQ);return ba.TreeReduce(w.get_Empty(),w.Append,bR);};w.Mk=function(bQ,bR){return new w.New(bQ,bR);};w.get_Empty=function(){return w.Mk(null,r.Const());};w.Append=function(bQ,bR){return w.Mk({$:0,$0:bQ.docNode,$1:bR.docNode},r.Map2Unit(bQ.updates,bR.updates));};w.TextNode=function(bQ){return w.Mk({$:5,$0:O.CreateText(bQ)},r.Const());};w.New=bL.Ctor(function(bQ,bR){e.New.call(this);this.docNode=bQ;this.updates=bR;},w);y.NewFromSeq=function(bQ){var bR,bS,bT;bR={};bS=R.Get(bQ);try{while(bS.MoveNext()){bT=bS.Current();bR[bT[0]]=bT[1];}}finally{if(typeof bS=="object"&&"Dispose"in bS)bS.Dispose();}return bR;};A=z.List=bL.Class({GetEnumerator:function(){return R.Get(this);},GetEnumerator0:function(){return R.Get0(this);}},null,A);B.Equals=function(bQ,bR){var bS,bT,bU,bV;if(bQ===bR)return true;else{bS=typeof bQ;if(bS=="object"){if(bQ===null||bQ===void 0||bR===null||bR===void 0)return false;else if("Equals"in bQ)return bQ.Equals(bR);else if(bQ instanceof a.Array&&bR instanceof a.Array)return B.arrayEquals(bQ,bR);else if(bQ instanceof a.Date&&bR instanceof a.Date)return B.dateEquals(bQ,bR);else{bT=[true];for(var bW in bQ)if(function(bX){bT[0]=!bQ.hasOwnProperty(bX)||bR.hasOwnProperty(bX)&&B.Equals(bQ[bX],bR[bX]);return!bT[0];}(bW))break;if(bT[0]){for(var bX in bR)if(function(bY){bT[0]=!bR.hasOwnProperty(bY)||bQ.hasOwnProperty(bY);return!bT[0];}(bX))break;}return bT[0];}}else return bS=="function"&&("$Func"in bQ?bQ.$Func===bR.$Func&&bQ.$Target===bR.$Target:"$Invokes"in bQ&&"$Invokes"in bR&&B.arrayEquals(bQ.$Invokes,bR.$Invokes));}};B.arrayEquals=function(bQ,bR){var bS,bT;if(n.length(bQ)===n.length(bR)){bS=true;bT=0;while(bS&&bT<n.length(bQ)){!B.Equals(n.get(bQ,bT),n.get(bR,bT))?bS=false:void 0;bT=bT+1;}return bS;}else return false;};B.dateEquals=function(bQ,bR){return bQ.getTime()===bR.getTime();};B.Hash=function(bQ){var bR;bR=typeof bQ;return bR=="function"?0:bR=="boolean"?bQ?1:0:bR=="number"?bQ:bR=="string"?B.hashString(bQ):bR=="object"?bQ==null?0:bQ instanceof a.Array?B.hashArray(bQ):B.hashObject(bQ):0;};B.hashString=function(bQ){var bR,bS,bT;if(bQ===null)return 0;else{bR=5381;for(bS=0,bT=bQ.length-1;bS<=bT;bS++)bR=B.hashMix(bR,bQ[bS].charCodeAt());return bR;}};B.hashArray=function(bQ){var bR,bS,bT;bR=-34948909;for(bS=0,bT=n.length(bQ)-1;bS<=bT;bS++)bR=B.hashMix(bR,B.Hash(n.get(bQ,bS)));return bR;};B.hashObject=function(bQ){var bR,bS;if("GetHashCode"in bQ)return bQ.GetHashCode();else{bR=[0];for(var bT in bQ)if(function(bU){bR[0]=B.hashMix(B.hashMix(bR[0],B.hashString(bU)),B.Hash(bQ[bU]));return false;}(bT))break;return bR[0];}};B.hashMix=function(bQ,bR){return(bQ<<5)+bQ+bR;};B.Compare=function(bQ,bR){var bS,bT,bU,bV,bW,bX;if(bQ===bR)return 0;else{bT=typeof bQ;switch(bT=="function"?1:bT=="boolean"?2:bT=="number"?2:bT=="string"?2:bT=="object"?3:0){case 0:return typeof bR=="undefined"?0:-1;case 1:return i.FailWith("Cannot compare function values.");case 2:return bQ<bR?-1:1;case 3:if(bQ===null)bU=-1;else if(bR===null)bU=1;else if("CompareTo"in bQ)bU=bQ.CompareTo(bR);else if("CompareTo0"in bQ)bU=bQ.CompareTo0(bR);else if(bQ instanceof a.Array&&bR instanceof a.Array)bU=B.compareArrays(bQ,bR);else if(bQ instanceof a.Date&&bR instanceof a.Date)bU=B.compareDates(bQ,bR);else{bV=[0];for(var bY in bQ)if(function(bZ){return!bQ.hasOwnProperty(bZ)?false:!bR.hasOwnProperty(bZ)?(bV[0]=1,true):(bV[0]=B.Compare(bQ[bZ],bR[bZ]),bV[0]!==0);}(bY))break;if(bV[0]===0){for(var bZ in bR)if(function(b0){return!bR.hasOwnProperty(b0)?false:!bQ.hasOwnProperty(b0)&&(bV[0]=-1,true);}(bZ))break;}bU=bV[0];}return bU;}}};B.compareArrays=function(bQ,bR){var bS,bT;if(n.length(bQ)<n.length(bR))return -1;else if(n.length(bQ)>n.length(bR))return 1;else{bS=0;bT=0;while(bS===0&&bT<n.length(bQ)){bS=B.Compare(n.get(bQ,bT),n.get(bR,bT));bT=bT+1;}return bS;}};B.compareDates=function(bQ,bR){return B.Compare(bQ.getTime(),bR.getTime());};D.NewGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new a.RegExp("[xy]","g"),function(bQ){var bR,bS;bR=bO.random()*16|0;bS=bQ=="x"?bR:bR&3|8;return bS.toString(16);});};E=z.Dictionary=bL.Class({set_Item:function(bQ,bR){this.set(bQ,bR);},set:function(bQ,bR){var bS,bT,bU,bV;bS=this;bT=this.hash(bQ);bU=this.data[bT];bU==null?(this.count=this.count+1,this.data[bT]=new a.Array({K:bQ,V:bR})):(bV=n.tryFindIndex(function(bW){return bS.equals.apply(null,[(i.KeyValue(bW))[0],bQ]);},bU),bV==null?(this.count=this.count+1,bU.push({K:bQ,V:bR})):bU[bV.$0]={K:bQ,V:bR});},ContainsKey:function(bQ){var bR,bS;bR=this;bS=this.data[this.hash(bQ)];return bS==null?false:n.exists(function(bT){return bR.equals.apply(null,[(i.KeyValue(bT))[0],bQ]);},bS);},TryGetValue:function(bQ,bR){var bS,bT,bU;bS=this;bT=this.data[this.hash(bQ)];return bT==null?false:(bU=n.tryPick(function(bV){var bW;bW=i.KeyValue(bV);return bS.equals.apply(null,[bW[0],bQ])?{$:1,$0:bW[1]}:null;},bT),bU!=null&&bU.$==1&&(bR.set(bU.$0),true));},Remove:function(bQ){return this.remove(bQ);},get_Keys:function(){return new _5.New(this);},remove:function(bQ){var bR,bS,bT,bU;bR=this;bS=this.hash(bQ);bT=this.data[bS];return bT==null?false:(bU=n.filter(function(bV){return!bR.equals.apply(null,[(i.KeyValue(bV))[0],bQ]);},bT),n.length(bU)<bT.length&&(this.count=this.count-1,this.data[bS]=bU,true));},get_Item:function(bQ){return this.get(bQ);},get:function(bQ){var bR,bS;bR=this;bS=this.data[this.hash(bQ)];return bS==null?Q.notPresent():n.pick(function(bT){var bU;bU=i.KeyValue(bT);return bR.equals.apply(null,[bU[0],bQ])?{$:1,$0:bU[1]}:null;},bS);},GetEnumerator:function(){return R.Get0(this);},GetEnumerator0:function(){return R.Get0(n.concat(N.GetFieldValues(this.data)));}},e,E);E.New$5=bL.Ctor(function(){E.New$6.call(this,[],B.Equals,B.Hash);},E);E.New$6=bL.Ctor(function(bQ,bR,bS){var bT,bU;e.New.call(this);this.equals=bR;this.hash=bS;this.count=0;this.data=[];bT=R.Get(bQ);try{while(bT.MoveNext()){bU=bT.Current();this.set(bU.K,bU.V);}}finally{if(typeof bT=="object"&&"Dispose"in bT)bT.Dispose();}},E);F=z.HashSet=bL.Class({Add:function(bQ){return this.add(bQ);},Contains:function(bQ){var bR;bR=this.data[this.hash(bQ)];return bR==null?false:this.arrContains(bQ,bR);},add:function(bQ){var bR,bS;bR=this.hash(bQ);bS=this.data[bR];return bS==null?(this.data[bR]=[bQ],this.count=this.count+1,true):this.arrContains(bQ,bS)?false:(bS.push(bQ),this.count=this.count+1,true);},arrContains:function(bQ,bR){var bS,bT,bU,bV;bS=true;bT=0;bV=bR.length;while(bS&&bT<bV)if(this.equals.apply(null,[bR[bT],bQ]))bS=false;else bT=bT+1;return!bS;},ExceptWith:function(bQ){var bR;bR=R.Get(bQ);try{while(bR.MoveNext())this.Remove(bR.Current());}finally{if(typeof bR=="object"&&"Dispose"in bR)bR.Dispose();}},get_Count:function(){return this.count;},CopyTo:function(bQ){var bR,bS,bT,bU;bR=0;bS=bb.concat(this.data);for(bT=0,bU=bS.length-1;bT<=bU;bT++)n.set(bQ,bT,bS[bT]);},IntersectWith:function(bQ){var bR,bS,bT,bU,bV;bR=new F.New$4(bQ,this.equals,this.hash);bS=bb.concat(this.data);for(bT=0,bU=bS.length-1;bT<=bU;bT++){bV=bS[bT];!bR.Contains(bV)?this.Remove(bV):void 0;}},Remove:function(bQ){var bR;bR=this.data[this.hash(bQ)];return bR==null?false:this.arrRemove(bQ,bR)&&(this.count=this.count-1,true);},arrRemove:function(bQ,bR){var bS,bT,bU,bV;bS=true;bT=0;bV=bR.length;while(bS&&bT<bV)if(this.equals.apply(null,[bR[bT],bQ])){bR.splice.apply(bR,[bT,1]);bS=false;}else bT=bT+1;return!bS;},GetEnumerator:function(){return R.Get(bb.concat(this.data));},GetEnumerator0:function(){return R.Get(bb.concat(this.data));}},e,F);F.New$3=bL.Ctor(function(){F.New$4.call(this,[],B.Equals,B.Hash);},F);F.New$4=bL.Ctor(function(bQ,bR,bS){var bT;e.New.call(this);this.equals=bR;this.hash=bS;this.data=[];this.count=0;bT=R.Get(bQ);try{while(bT.MoveNext())this.add(bT.Current());}finally{if(typeof bT=="object"&&"Dispose"in bT)bT.Dispose();}},F);F.New$2=bL.Ctor(function(bQ){F.New$4.call(this,bQ,B.Equals,B.Hash);},F);G.Box=a.id;H.append=function(bQ,bR){return{GetEnumerator:function(){var bS,bT;bS=R.Get(bQ);bT=[true];return new S.New(bS,null,function(bU){var bV;return bU.s.MoveNext()?(bU.c=bU.s.Current(),true):(bV=bU.s,!B.Equals(bV,null)?bV.Dispose():void 0,bU.s=null,bT[0]&&(bT[0]=false,bU.s=R.Get(bR),bU.s.MoveNext()?(bU.c=bU.s.Current(),true):(bU.s.Dispose(),bU.s=null,false)));},function(bU){var bV;bV=bU.s;!B.Equals(bV,null)?bV.Dispose():void 0;});}};};H.head=function(bQ){var bR;bR=R.Get(bQ);try{return bR.MoveNext()?bR.Current():H.insufficient();}finally{if(typeof bR=="object"&&"Dispose"in bR)bR.Dispose();}};H.fold=function(bQ,bR,bS){var bT,bU;bT=bR;bU=R.Get(bS);try{while(bU.MoveNext())bT=bQ(bT,bU.Current());return bT;}finally{if(typeof bU=="object"&&"Dispose"in bU)bU.Dispose();}};H.iter=function(bQ,bR){var bS;bS=R.Get(bR);try{while(bS.MoveNext())bQ(bS.Current());}finally{if(typeof bS=="object"&&"Dispose"in bS)bS.Dispose();}};H.map=function(bQ,bR){return{GetEnumerator:function(){var bS;bS=R.Get(bR);return new S.New(null,null,function(bT){return bS.MoveNext()&&(bT.c=bQ(bS.Current()),true);},function(){bS.Dispose();});}};};H.max=function(bQ){var bR,bS,bT;bR=R.Get(bQ);try{if(!bR.MoveNext())H.seqEmpty();bS=bR.Current();while(bR.MoveNext()){bT=bR.Current();B.Compare(bT,bS)===1?bS=bT:void 0;}return bS;}finally{if(typeof bR=="object"&&"Dispose"in bR)bR.Dispose();}};H.seqEmpty=function(){return i.FailWith("The input sequence was empty.");};H.forall=function(bQ,bR){return!H.exists(function(bS){return!bQ(bS);},bR);};H.exists=function(bQ,bR){var bS,bT;bS=R.Get(bR);try{bT=false;while(!bT&&bS.MoveNext())bT=bQ(bS.Current());return bT;}finally{if(typeof bS=="object"&&"Dispose"in bS)bS.Dispose();}};n.choose=function(bQ,bR){var bS,bT,bU,bV;bS=[];for(bT=0,bU=bR.length-1;bT<=bU;bT++){bV=bQ(bR[bT]);bV==null?void 0:bS.push(bV.$0);}return bS;};n.tryFindIndex=function(bQ,bR){var bS,bT;bS=null;bT=0;while(bT<bR.length&&bS==null){bQ(bR[bT])?bS={$:1,$0:bT}:void 0;bT=bT+1;}return bS;};n.exists=function(bQ,bR){var bS,bT,bU,bV;bS=false;bT=0;bV=n.length(bR);while(!bS&&bT<bV)if(bQ(bR[bT]))bS=true;else bT=bT+1;return bS;};n.tryPick=function(bQ,bR){var bS,bT,bU;bS=null;bT=0;while(bT<bR.length&&bS==null){bU=bQ(bR[bT]);bU!=null&&bU.$==1?bS=bU:void 0;bT=bT+1;}return bS;};n.concat=function(bQ){return a.Array.prototype.concat.apply([],n.ofSeq(bQ));};n.filter=function(bQ,bR){var bS,bT,bU;bS=[];for(bT=0,bU=bR.length-1;bT<=bU;bT++)if(bQ(bR[bT]))bS.push(bR[bT]);return bS;};n.map=function(bQ,bR){var bS,bT,bU;bS=new a.Array(bR.length);for(bT=0,bU=bR.length-1;bT<=bU;bT++)bS[bT]=bQ(bR[bT]);return bS;};n.iter=function(bQ,bR){var bS,bT;for(bS=0,bT=bR.length-1;bS<=bT;bS++)bQ(bR[bS]);};n.foldBack=function(bQ,bR,bS){var bT,bU,bV,bW,bX;bT=bS;bV=bR.length;for(bW=1,bX=bV;bW<=bX;bW++)bT=bQ(bR[bV-bW],bT);return bT;};n.ofList=function(bQ){var bR,bS;bS=[];bR=bQ;while(!(bR.$==0)){bS.push(bl.head(bR));bR=bl.tail(bR);}return bS;};n.ofSeq=function(bQ){var bR,bS;if(bQ instanceof a.Array)return bQ.slice();else if(bQ instanceof bm)return n.ofList(bQ);else{bR=[];bS=R.Get(bQ);try{while(bS.MoveNext())bR.push(bS.Current());return bR;}finally{if(typeof bS=="object"&&"Dispose"in bS)bS.Dispose();}}};n.pick=function(bQ,bR){var bS;bS=n.tryPick(bQ,bR);return bS==null?i.FailWith("KeyNotFoundException"):bS.$0;};n.create=function(bQ,bR){var bS,bT,bU;bS=new a.Array(bQ);for(bT=0,bU=bQ-1;bT<=bU;bT++)bS[bT]=bR;return bS;};n.forall=function(bQ,bR){var bS,bT,bU,bV;bS=true;bT=0;bV=n.length(bR);while(bS&&bT<bV)if(bQ(bR[bT]))bT=bT+1;else bS=false;return bS;};n.init=function(bQ,bR){var bS,bT,bU;bQ<0?i.FailWith("Negative size given."):null;bS=new a.Array(bQ);for(bT=0,bU=bQ-1;bT<=bU;bT++)bS[bT]=bR(bT);return bS;};I.DynamicCustom=function(bQ,bR){return W.Dynamic(bR,bQ);};I.Handler=function(bQ,bR){return W.Static(function(bS){bS.addEventListener(bQ,function(bT){return(bR(bS))(bT);},false);});};I.OnAfterRender=function(bQ){return new T({$:4,$0:bQ});};I.Value=function(bQ){function bR(bS){return{$:1,$0:bS};}return I.CustomValue(bQ,a.id,function(bS){return bR(a.id(bS));});};I.Checked=function(bQ){function bR(bS,bT){return!B.Equals(bQ.Get(),bS.checked)?bQ.Set(bS.checked):null;}return T.Concat([I.DynamicProp("checked",bQ.get_View()),I.Handler("change",function(bS){return function(bT){return bR(bS,bT);};})]);};I.IntValue=function(bQ){return I.CustomVar(bQ,function(bR,bS){var bT;bT=bS.get_Input();return bR.value!==bT?void(bR.value=bT):null;},function(bR){var bS,bT,bU;bS=bR.value;return{$:1,$0:bx.isBlank(bS)?(bR.checkValidity?bR.checkValidity():true)?new U({$:2,$0:bS}):new U({$:1,$0:bS}):(bT=(bU=0,[V.TryParseInt32(bS,{get:function(){return bU;},set:function(bV){bU=bV;}}),bU]),bT[0]?new U({$:0,$0:bT[1],$1:bS}):new U({$:1,$0:bS}))};});};I.IntValueUnchecked=function(bQ){return I.CustomValue(bQ,a.String,function(bR){var bS;return bx.isBlank(bR)?{$:1,$0:0}:(bS=+bR,bS!==bS>>0?null:{$:1,$0:bS});});};I.FloatValue=function(bQ){return I.CustomVar(bQ,function(bR,bS){var bT;bT=bS.get_Input();return bR.value!==bT?void(bR.value=bT):null;},function(bR){var bS,bT;bS=bR.value;return{$:1,$0:bx.isBlank(bS)?(bR.checkValidity?bR.checkValidity():true)?new U({$:2,$0:bS}):new U({$:1,$0:bS}):(bT=+bS,a.isNaN(bT)?new U({$:1,$0:bS}):new U({$:0,$0:bT,$1:bS}))};});};I.FloatValueUnchecked=function(bQ){return I.CustomValue(bQ,a.String,function(bR){var bS;return bx.isBlank(bR)?{$:1,$0:0}:(bS=+bR,a.isNaN(bS)?null:{$:1,$0:bS});});};I.Dynamic=function(bQ,bR){return W.Dynamic(bR,function(bS){return function(bT){return O.SetAttr(bS,bQ,bT);};});};I.CustomValue=function(bQ,bR,bS){return I.CustomVar(bQ,function(bT,bU){bT.value=bR(bU);},function(bT){return bS(bT.value);});};I.DynamicProp=function(bQ,bR){return W.Dynamic(bR,function(bS){return function(bT){bS[bQ]=bT;};});};I.CustomVar=function(bQ,bR,bS){function bT(bV,bW){return bQ.UpdateMaybe(function(bX){var bY,bZ;bY=bS(bV);return bY!=null&&bY.$==1&&(!B.Equals(bY.$0,bX)&&(bZ=[bY,bY.$0],true))?bZ[0]:null;});}function bU(bV,bW){var bX,bY;bX=bS(bV);return bX!=null&&bX.$==1&&(B.Equals(bX.$0,bW)&&(bY=bX.$0,true))?null:bR(bV,bW);}return T.Concat([I.Handler("change",function(bV){return function(bW){return bT(bV,bW);};}),I.Handler("input",function(bV){return function(bW){return bT(bV,bW);};}),I.Handler("keypress",function(bV){return function(bW){return bT(bV,bW);};}),I.DynamicCustom(function(bV){return function(bW){return bU(bV,bW);};},bQ.get_View())]);};r.Map=function(bQ,bR){return r.CreateLazy(function(){return t.Map(bQ,bR());});};r.CreateLazy=function(bQ){var bR;bR={c:null,o:bQ};return function(){var bS,bT;bS=bR.c;return bS===null?(bS=bR.o(),bR.c=bS,(bT=bS.s,bT!=null&&bT.$==0)?bR.o=null:t.WhenObsoleteRun(bS,function(){bR.c=null;}),bS):bS;};};r.Sink=function(bQ,bR){function bS(){t.WhenRun(bR(),bQ,function(){bo.scheduler().Fork(bS);});}bo.scheduler().Fork(bS);};r.Const=function(bQ){var bR;bR=t.New({$:0,$0:bQ});return function(){return bR;};};r.Map2Unit=function(bQ,bR){return r.CreateLazy(function(){return t.Map2Unit(bQ(),bR());});};r.Map3=function(bQ,bR,bS,bT){return r.CreateLazy(function(){return t.Map3(bQ,bR(),bS(),bT());});};r.Sequence=function(bQ){return r.CreateLazy(function(){return t.Sequence(H.map(function(bR){return bR();},bQ));});};r.Map2=function(bQ,bR,bS){return r.CreateLazy(function(){return t.Map2(bQ,bR(),bS());});};K.Int=function(){K.set_counter(K.counter()+1);return K.counter();};K.set_counter=function(bQ){_2.$cctor();_2.counter=bQ;};K.counter=function(){_2.$cctor();return _2.counter;};N.GetFieldValues=function(bQ){var bR,bS;bR=[];for(var bT in bQ)bR.push(bQ[bT]);return bR;};O.Doc=function(){Z.$cctor();return Z.Doc;};O.ChildrenArray=function(bQ){var bR,bS,bT;bR=[];for(bS=0,bT=bQ.childNodes.length-1;bS<=bT;bS++)bR.push(bQ.childNodes[bS]);return bR;};O.CreateElement=function(bQ){return O.Doc().createElement(bQ);};O.IterSelector=function(bQ,bR,bS){var bT,bU,bV;bT=bQ.querySelectorAll(bR);for(bU=0,bV=bT.length-1;bU<=bV;bU++)bS(bT[bU]);};O.CreateText=function(bQ){return O.Doc().createTextNode(bQ);};O.InsertAt=function(bQ,bR,bS){var bT;if(!(bS.parentNode===bQ&&bR===(bT=bS.nextSibling,B.Equals(bT,null)?null:bT)))bQ.insertBefore(bS,bR);};O.SetAttr=function(bQ,bR,bS){bQ.setAttribute(bR,bS);};O.RemoveNode=function(bQ,bR){if(bR.parentNode===bQ)bQ.removeChild(bR);};Q.notPresent=function(){return i.FailWith("The given key was not present in the dictionary.");};R.Get=function(bQ){return bQ instanceof a.Array?R.ArrayEnumerator(bQ):B.Equals(typeof bQ,"string")?R.StringEnumerator(bQ):bQ.GetEnumerator();};R.ArrayEnumerator=function(bQ){return new S.New(0,null,function(bR){var bS;bS=bR.s;return bS<n.length(bQ)&&(bR.c=n.get(bQ,bS),bR.s=bS+1,true);},void 0);};R.StringEnumerator=function(bQ){return new S.New(0,null,function(bR){var bS;bS=bR.s;return bS<bQ.length&&(bR.c=bQ[bS],bR.s=bS+1,true);},void 0);};R.Get0=function(bQ){return bQ instanceof a.Array?R.ArrayEnumerator(bQ):B.Equals(typeof bQ,"string")?R.StringEnumerator(bQ):"GetEnumerator0"in bQ?bQ.GetEnumerator0():bQ.GetEnumerator();};S=R.T=bL.Class({MoveNext:function(){return this.n(this);},Current:function(){return this.c;},Dispose:function(){if(this.d)this.d(this);}},e,S);S.New=bL.Ctor(function(bQ,bR,bS,bT){e.New.call(this);this.s=bQ;this.c=bR;this.n=bS;this.d=bT;},S);T=f.AttrProxy=bL.Class({},null,T);T.Concat=function(bQ){var bR;bR=ba.ofSeqNonCopying(bQ);return ba.TreeReduce(W.EmptyAttr(),T.Append,bR);};T.Append=function(bQ,bR){return W.AppendTree(bQ,bR);};T.Handler=function(bQ,bR){return T.HandlerImpl(bQ,bR);};T.Create=function(bQ,bR){return W.Static(function(bS){O.SetAttr(bS,bQ,bR);});};T.HandlerImpl=function(bQ,bR){return W.Static(function(bS){bS.addEventListener(bQ,function(bT){return(bR(bS))(bT);},false);});};U=f.CheckedInput=bL.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1;}},null,U);V.TryParseInt32=function(bQ,bR){return V.TryParse(bQ,-2147483648,2147483647,bR);};W.Dynamic=function(bQ,bR){return new T({$:1,$0:new _1.New(bQ,bR)});};W.Updates=function(bQ){return ba.MapTreeReduce(function(bR){return bR.NChanged();},r.Const(),r.Map2Unit,bQ.DynNodes);};W.AppendTree=function(bQ,bR){var bS;return bQ===null?bR:bR===null?bQ:(bS=new T({$:2,$0:bQ,$1:bR}),(W.SetFlags(bS,W.Flags(bQ)|W.Flags(bR)),bS));};W.EmptyAttr=function(){bq.$cctor();return bq.EmptyAttr;};W.Insert=function(bQ,bR){var bS,bT,bU;function bV(bW){if(!(bW===null))if(bW!=null&&bW.$==1)bS.push(bW.$0);else if(bW!=null&&bW.$==2){bV(bW.$0);bV(bW.$1);}else if(bW!=null&&bW.$==3)bW.$0(bQ);else if(bW!=null&&bW.$==4)bT.push(bW.$0);}bS=[];bT=[];bV(bR);bU=bS.slice(0);return be.New(bQ,W.Flags(bR),bU,bT.length===0?null:{$:1,$0:function(bW){H.iter(function(bX){bX(bW);},bT);}});};W.HasExitAnim=function(bQ){var bR;bR=2;return(bQ.DynFlags&bR)===bR;};W.GetExitAnim=function(bQ){return W.GetAnim(bQ,function(bR,bS){return bR.NGetExitAnim(bS);});};W.HasEnterAnim=function(bQ){var bR;bR=1;return(bQ.DynFlags&bR)===bR;};W.GetEnterAnim=function(bQ){return W.GetAnim(bQ,function(bR,bS){return bR.NGetEnterAnim(bS);});};W.HasChangeAnim=function(bQ){var bR;bR=4;return(bQ.DynFlags&bR)===bR;};W.GetChangeAnim=function(bQ){return W.GetAnim(bQ,function(bR,bS){return bR.NGetChangeAnim(bS);});};W.Empty=function(bQ){return be.New(bQ,0,[],null);};W.SetFlags=function(bQ,bR){bQ.flags=bR;};W.Flags=function(bQ){return bQ!==null&&bQ.hasOwnProperty("flags")?bQ.flags:0;};W.GetAnim=function(bQ,bR){return _8.Concat(n.map(function(bS){return bR(bS,bQ.DynElem);},bQ.DynNodes));};W.Sync=function(bQ,bR){n.iter(function(bS){bS.NSync(bQ);},bR.DynNodes);};W.Static=function(bQ){return new T({$:3,$0:bQ});};t.Obsolete=function(bQ){var bR,bS,bT,bU,bV;bS=bQ.s;if(bS==null||(bS!=null&&bS.$==2?(bR=bS.$1,false):bS!=null&&bS.$==3?(bR=bS.$1,false):true))void 0;else{bQ.s=null;for(bT=0,bU=n.length(bR)-1;bT<=bU;bT++){bV=n.get(bR,bT);typeof bV=="object"?function(bW){t.Obsolete(bW);}(bV):bV();}}};t.New=function(bQ){return{s:bQ};};X.$cctor=function(){X.$cctor=a.ignore;X.LoadedTemplates=new E.New$5();X.LocalTemplatesLoaded=false;X.TextHoleRE="\\${([^}]+)}";};Z.$cctor=function(){Z.$cctor=a.ignore;Z.Doc=self.document;};_0.LinkElement=function(bQ,bR){_0.InsertDoc(bQ,bR,null);};_0.CreateTextNode=function(){return{Text:O.CreateText(""),Dirty:false,Value:""};};_0.UpdateTextNode=function(bQ,bR){bQ.Value=bR;bQ.Dirty=true;};_0.InsertDoc=function(bQ,bR,bS){var bT;return bR!=null&&bR.$==1?_0.InsertNode(bQ,bR.$0.El,bS):bR!=null&&bR.$==2?(bT=bR.$0,(bT.Dirty=false,_0.InsertDoc(bQ,bT.Current,bS))):bR==null?bS:bR!=null&&bR.$==4?_0.InsertNode(bQ,bR.$0.Text,bS):bR!=null&&bR.$==5?_0.InsertNode(bQ,bR.$0,bS):bR!=null&&bR.$==6?n.foldBack(function(bU,bV){return bU==null||bU.constructor===P?_0.InsertDoc(bQ,bU,bV):_0.InsertNode(bQ,bU,bV);},bR.$0.Els,bS):_0.InsertDoc(bQ,bR.$0,_0.InsertDoc(bQ,bR.$1,bS));};_0.CreateRunState=function(bQ,bR){return bg.New(bh.get_Empty(),_0.CreateElemNode(bQ,W.EmptyAttr(),bR));};_0.PerformAnimatedUpdate=function(bQ,bR,bS){var bT;return _8.get_UseAnimations()?(bT=null,bo.Delay(function(){var bU,bV,bW;bU=bh.FindAll(bS);bV=_0.ComputeChangeAnim(bR,bU);bW=_0.ComputeEnterAnim(bR,bU);return bo.Bind(_8.Play(_8.Append(bV,_0.ComputeExitAnim(bR,bU))),function(){return bo.Bind(_0.SyncElemNodesNextFrame(bQ,bR),function(){return bo.Bind(_8.Play(bW),function(){bR.PreviousNodes=bU;return bo.Return(null);});});});})):_0.SyncElemNodesNextFrame(bQ,bR);};_0.PerformSyncUpdate=function(bQ,bR,bS){var bT;bT=bh.FindAll(bS);_0.SyncElemNode(bQ,bR.Top);bR.PreviousNodes=bT;};_0.InsertNode=function(bQ,bR,bS){O.InsertAt(bQ,bS,bR);return bR;};_0.CreateElemNode=function(bQ,bR,bS){var bT;_0.LinkElement(bQ,bS);bT=W.Insert(bQ,bR);return _6.New(bT,bS,null,bQ,K.Int(),bL.GetOptional(bT.OnAfterRender));};_0.SyncElemNodesNextFrame=function(bQ,bR){function bS(bT){a.requestAnimationFrame(function(){_0.SyncElemNode(bQ,bR.Top);bT();});}return _9.BatchUpdatesEnabled()?bo.FromContinuations(function(bT,bU,bV){return bS.apply(null,[bT,bU,bV]);}):(_0.SyncElemNode(bQ,bR.Top),bo.Return(null));};_0.ComputeExitAnim=function(bQ,bR){return _8.Concat(n.map(function(bS){return W.GetExitAnim(bS.Attr);},bh.ToArray(bh.Except(bR,bh.Filter(function(bS){return W.HasExitAnim(bS.Attr);},bQ.PreviousNodes)))));};_0.ComputeEnterAnim=function(bQ,bR){return _8.Concat(n.map(function(bS){return W.GetEnterAnim(bS.Attr);},bh.ToArray(bh.Except(bQ.PreviousNodes,bh.Filter(function(bS){return W.HasEnterAnim(bS.Attr);},bR)))));};_0.ComputeChangeAnim=function(bQ,bR){var bS;function bT(bU){return W.HasChangeAnim(bU.Attr);}bS=function(bU){return bh.Filter(bT,bU);};return _8.Concat(n.map(function(bU){return W.GetChangeAnim(bU.Attr);},bh.ToArray(bh.Intersect(bS(bQ.PreviousNodes),bS(bR)))));};_0.SyncElemNode=function(bQ,bR){!bQ?_0.SyncElement(bR):void 0;_0.Sync(bR.Children);_0.AfterRender(bR);};_0.SyncElement=function(bQ){function bR(bS){function bT(bU){var bV,bW;return bU!=null&&bU.$==0?bT(bU.$0)||bT(bU.$1):bU!=null&&bU.$==2?(bV=bU.$0,bV.Dirty||bT(bV.Current)):bU!=null&&bU.$==6&&(bW=bU.$0,bW.Dirty||n.exists(bR,bW.Holes));}return bT(bS.Children);}W.Sync(bQ.El,bQ.Attr);bR(bQ)?_0.DoSyncElement(bQ):void 0;};_0.Sync=function(bQ){var bR,bS;if(bQ!=null&&bQ.$==1)_0.SyncElemNode(false,bQ.$0);else if(bQ!=null&&bQ.$==2)_0.Sync(bQ.$0.Current);else if(bQ==null);else if(bQ!=null&&bQ.$==5);else if(bQ!=null&&bQ.$==4){bR=bQ.$0;bR.Dirty?(bR.Text.nodeValue=bR.Value,bR.Dirty=false):void 0;}else if(bQ!=null&&bQ.$==6){bS=bQ.$0;n.iter(function(bT){_0.SyncElemNode(false,bT);},bS.Holes);n.iter(function(bT){W.Sync(bT[0],bT[1]);},bS.Attrs);_0.AfterRender(bS);}else{_0.Sync(bQ.$0);_0.Sync(bQ.$1);}};_0.AfterRender=function(bQ){var bR;bR=bL.GetOptional(bQ.Render);bR!=null&&bR.$==1?(bR.$0(bQ.El),bL.SetOptional(bQ,"Render",null)):void 0;};_0.InsertBeforeDelim=function(bQ,bR){var bS,bT;bS=bQ.parentNode;bT=self.document.createTextNode("");bS.insertBefore(bT,bQ);_0.LinkPrevElement(bQ,bR);return bT;};_0.DoSyncElement=function(bQ){var bR,bS,bT;function bU(bV,bW){var bX,bY;return bV!=null&&bV.$==1?bV.$0.El:bV!=null&&bV.$==2?(bX=bV.$0,bX.Dirty?(bX.Dirty=false,_0.InsertDoc(bR,bX.Current,bW)):bU(bX.Current,bW)):bV==null?bW:bV!=null&&bV.$==4?bV.$0.Text:bV!=null&&bV.$==5?bV.$0:bV!=null&&bV.$==6?(bY=bV.$0,(bY.Dirty?bY.Dirty=false:void 0,n.foldBack(function(bZ,b0){return bZ==null||bZ.constructor===P?bU(bZ,b0):bZ;},bY.Els,bW))):bU(bV.$0,bU(bV.$1,bW));}bR=bQ.El;bA.Iter((bS=bQ.El,function(bV){O.RemoveNode(bS,bV);}),bA.Except(bA.DocChildren(bQ),bA.Children(bQ.El,bL.GetOptional(bQ.Delimiters))));bU(bQ.Children,(bT=bL.GetOptional(bQ.Delimiters),bT!=null&&bT.$==1?bT.$0[1]:null));};_0.LinkPrevElement=function(bQ,bR){_0.InsertDoc(bQ.parentNode,bR,bQ);};_1=f.DynamicAttrNode=bL.Class({NChanged:function(){return this.updates;},NGetExitAnim:function(bQ){return _8.get_Empty();},NGetEnterAnim:function(bQ){return _8.get_Empty();},NGetChangeAnim:function(bQ){return _8.get_Empty();},NSync:function(bQ){if(this.dirty){(this.push(bQ))(this.value);this.dirty=false;}}},e,_1);_1.New=bL.Ctor(function(bQ,bR){var bS;bS=this;e.New.call(this);this.push=bR;this.value=void 0;this.dirty=false;this.updates=r.Map(function(bT){bS.value=bT;bS.dirty=true;},bQ);},_1);_2.$cctor=function(){_2.$cctor=a.ignore;_2.counter=0;};_3.convertTextNode=function(bQ){var bR,bS,bT,bU,bV,bW;bR=null;bS=0;bU=bQ.textContent;bV=new a.RegExp(v.TextHoleRE(),"g");while(bR=bV.exec(bU),bR!==null){bQ.parentNode.insertBefore(self.document.createTextNode(_4.string(bU,{$:1,$0:bS},{$:1,$0:bV.lastIndex-n.get(bR,0).length-1})),bQ);bS=bV.lastIndex;bW=self.document.createElement("span");bW.setAttribute("ws-replace",n.get(bR,1).toLowerCase());bQ.parentNode.insertBefore(bW,bQ);}bV.lastIndex=0;bQ.textContent=_4.string(bU,{$:1,$0:bS},null);};_3.failNotLoaded=function(bQ){bN.warn("Instantiating non-loaded template",bQ);};_3.fillTextHole=function(bQ,bR,bS){var bT;bT=bQ.querySelector("[ws-replace]");return B.Equals(bT,null)?(bN.warn("Filling non-existent text hole",bS),null):(bT.parentNode.replaceChild(new a.Text(bR),bT),{$:1,$0:bT.getAttribute("ws-replace")});};_3.removeHolesExcept=function(bQ,bR){function bS(bT){O.IterSelector(bQ,"["+bT+"]",function(bU){if(!bR.Contains(bU.getAttribute(bT)))bU.removeAttribute(bT);});}bS("ws-attr");bS("ws-onafterrender");bS("ws-var");O.IterSelector(bQ,"[ws-hole]",function(bT){if(!bR.Contains(bT.getAttribute("ws-hole"))){bT.removeAttribute("ws-hole");while(bT.hasChildNodes())bT.removeChild(bT.lastChild);}});O.IterSelector(bQ,"[ws-replace]",function(bT){if(!bR.Contains(bT.getAttribute("ws-replace")))bT.parentNode.removeChild(bT);});O.IterSelector(bQ,"[ws-on]",function(bT){bT.setAttribute("ws-on",bc.concat(" ",n.filter(function(bU){return bR.Contains(n.get(bc.SplitChars(bU,[":"],1),1));},bc.SplitChars(bT.getAttribute("ws-on"),[" "],1))));});O.IterSelector(bQ,"[ws-attr-holes]",function(bT){var bU,bV,bW,bX,bY;bU=bc.SplitChars(bT.getAttribute("ws-attr-holes"),[" "],1);for(bV=0,bW=bU.length-1;bV<=bW;bV++){bX=n.get(bU,bV);bT.setAttribute(bX,(bY=new a.RegExp(v.TextHoleRE(),"g"),bT.getAttribute(bX).replace(bY,function(bZ,b0){return bR.Contains(b0)?bZ:"";})));}});};_3.fillInstanceAttrs=function(bQ,bR){var bS,bT,bU,bV,bW;_3.convertAttrs(bR);bS=bR.nodeName.toLowerCase();bT=bQ.querySelector("[ws-attr="+bS+"]");if(B.Equals(bT,null))bN.warn("Filling non-existent attr hole",bS);else{bT.removeAttribute("ws-attr");for(bU=0,bV=bR.attributes.length-1;bU<=bV;bU++){bW=bR.attributes.item(bU);bW.name==="class"&&bT.hasAttribute("class")?bT.setAttribute("class",bT.getAttribute("class")+" "+bW.nodeValue):bT.setAttribute(bW.name,bW.nodeValue);}}};_3.mapHoles=function(bQ,bR){function bS(bT){O.IterSelector(bQ,"["+bT+"]",function(bU){var bV,bW;bV=(bW=null,[bR.TryGetValue(bU.getAttribute(bT).toLowerCase(),{get:function(){return bW;},set:function(bX){bW=bX;}}),bW]);bV[0]?bU.setAttribute(bT,bV[1]):void 0;});}bS("ws-hole");bS("ws-replace");bS("ws-attr");bS("ws-onafterrender");bS("ws-var");O.IterSelector(bQ,"[ws-on]",function(bT){bT.setAttribute("ws-on",bc.concat(" ",n.map(function(bU){var bV,bW,bX;bV=bc.SplitChars(bU,[":"],1);bW=(bX=null,[bR.TryGetValue(n.get(bV,1),{get:function(){return bX;},set:function(bY){bX=bY;}}),bX]);return bW[0]?n.get(bV,0)+":"+bW[1]:bU;},bc.SplitChars(bT.getAttribute("ws-on"),[" "],1))));});O.IterSelector(bQ,"[ws-attr-holes]",function(bT){var bU,bV,bW;bU=bc.SplitChars(bT.getAttribute("ws-attr-holes"),[" "],1);for(bV=0,bW=bU.length-1;bV<=bW;bV++)(function(){var bX;function bY(bZ,b0){var b1;b1=i.KeyValue(b0);return bZ.replace(new a.RegExp("\\${"+b1[0]+"}","ig"),"${"+b1[1]+"}");}bX=n.get(bU,bV);return bT.setAttribute(bX,(((bL.Curried3(H.fold))(bY))(bT.getAttribute(bX)))(bR));}());});};_3.fill=function(bQ,bR,bS){while(true)if(bQ.hasChildNodes())bS=bR.insertBefore(bQ.lastChild,bS);else return null;};_3.convertAttrs=function(bQ){var bS,bT,bU,bV,bW,bX,bY,bZ;function bR(b0){var b1;b1=bQ.getAttribute(b0);b1===null?void 0:bQ.setAttribute(b0,b1.toLowerCase());}bS=bQ.attributes;bT=[];bU=[];bV=[];for(bW=0,bX=bS.length-1;bW<=bX;bW++){bY=bS.item(bW);bc.StartsWith(bY.nodeName,"ws-on")&&bY.nodeName!=="ws-onafterrender"&&bY.nodeName!=="ws-on"?(bT.push(bY.nodeName),bU.push(_4.string(bY.nodeName,{$:1,$0:"ws-on".length},null)+":"+bY.nodeValue.toLowerCase())):!bc.StartsWith(bY.nodeName,"ws-")&&(new a.RegExp(v.TextHoleRE())).test(bY.nodeValue)?(bY.nodeValue=(bZ=new a.RegExp(v.TextHoleRE(),"g"),bY.nodeValue.replace(bZ,function(b0,b1){return"${"+b1.toLowerCase()+"}";})),bV.push(bY.nodeName)):void 0;}!(bU.length==0)?bQ.setAttribute("ws-on",bc.concat(" ",bU)):void 0;!(bV.length==0)?bQ.setAttribute("ws-attr-holes",bc.concat(" ",bV)):void 0;bR("ws-hole");bR("ws-replace");bR("ws-attr");bR("ws-onafterrender");bR("ws-var");n.iter(function(b0){bQ.removeAttribute(b0);},bT);};_4.string=function(bQ,bR,bS){return bR==null?bS!=null&&bS.$==1?bQ.slice(0,bS.$0+1):"":bS==null?bQ.slice(bR.$0):bQ.slice(bR.$0,bS.$0+1);};H.insufficient=function(){return i.FailWith("The input sequence has an insufficient number of elements.");};_5=z.KeyCollection=bL.Class({GetEnumerator$1:function(){return R.Get(H.map(function(bQ){return bQ.K;},this.d));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();}},e,_5);_5.New=bL.Ctor(function(bQ){e.New.call(this);this.d=bQ;},_5);_6=f.DocElemNode=bL.Class({Equals:function(bQ){return this.ElKey===bQ.ElKey;},GetHashCode:function(){return this.ElKey;}},null,_6);_6.New=function(bQ,bR,bS,bT,bU,bV){var bW;return new _6((bW={Attr:bQ,Children:bR,El:bT,ElKey:bU},(bL.SetOptional(bW,"Delimiters",bS),bL.SetOptional(bW,"Render",bV),bW)));};_8.get_UseAnimations=function(){return bi.UseAnimations();};_8.Play=function(bQ){var bR;bR=null;return bo.Delay(function(){return bo.Bind(_8.Run(a.ignore,bi.Actions(bQ)),function(){bi.Finalize(bQ);return bo.Return(null);});});};_8.Append=function(bQ,bR){return{$:0,$0:bp.Append(bQ.$0,bR.$0)};};_8.Run=function(bQ,bR){var bS;function bT(bU){function bV(bW,bX){var bY;bY=bX-bW;bR.Compute(bY);bQ();return bY<=bS?void a.requestAnimationFrame(function(bZ){bV(bW,bZ);}):bU();}a.requestAnimationFrame(function(bW){bV(bW,bW);});}bS=bR.Duration;return bS===0?bo.Zero():bo.FromContinuations(function(bU,bV,bW){return bT.apply(null,[bU,bV,bW]);});};_8.Concat=function(bQ){return{$:0,$0:bp.Concat(H.map(bi.List,bQ))};};_8.get_Empty=function(){return{$:0,$0:bp.Empty()};};_9.BatchUpdatesEnabled=function(){bj.$cctor();return bj.BatchUpdatesEnabled;};_.StartProcessor=function(bQ){var bR;function bS(){var bT;bT=null;return bo.Delay(function(){return bo.Bind(bQ,function(){var bU;bU=bR[0];return bU===1?(bR[0]=0,bo.Zero()):bU===2?(bR[0]=1,bS()):bo.Zero();});});}bR=[0];return function(){var bT;bT=bR[0];bT===0?(bR[0]=1,bo.Start(bS(),null)):bT===1?bR[0]=2:void 0;};};$=f.Elt=bL.Class({},w,$);$.New=function(bQ,bR,bS){var bT,bU;bT=_0.CreateElemNode(bQ,bR,bS.docNode);bU=bk.Create(bS.updates);return new $.New$1({$:1,$0:bT},r.Map2Unit(W.Updates(bT.Attr),bU.v),bQ,bU);};$.TreeNode=function(bQ,bR){var bS,bT;function bU(bV){return bV[1];}bS=bk.Create(bR);return new $.New$1({$:6,$0:bQ},r.Map2Unit((bT=n.map(function(bV){return W.Updates(bU(bV));},bQ.Attrs),ba.TreeReduce(r.Const(),r.Map2Unit,bT)),bS.v),n.get(bQ.Els,0),bS);};$.New$1=bL.Ctor(function(bQ,bR,bS,bT){w.New.call(this,bQ,bR);this.docNode$1=bQ;this.updates$1=bR;this.elt=bS;this.rvUpdates=bT;},$);ba.ofSeqNonCopying=function(bQ){var bR,bS;if(bQ instanceof a.Array)return bQ;else if(bQ instanceof bm)return n.ofList(bQ);else if(bQ===null)return[];else{bR=[];bS=R.Get(bQ);try{while(bS.MoveNext())bR.push(bS.Current());return bR;}finally{if(typeof bS=="object"&&"Dispose"in bS)bS.Dispose();}}};ba.TreeReduce=function(bQ,bR,bS){var bT;function bU(bV,bW){var bX,bY;return bW<=0?bQ:bW===1&&(bV>=0&&bV<bT)?n.get(bS,bV):(bY=bW/2>>0,bR(bU(bV,bY),bU(bV+bY,bW-bY)));}bT=n.length(bS);return bU(0,bT);};ba.MapTreeReduce=function(bQ,bR,bS,bT){var bU;function bV(bW,bX){var bY,bZ;return bX<=0?bR:bX===1&&(bW>=0&&bW<bU)?bQ(n.get(bT,bW)):(bZ=bX/2>>0,bS(bV(bW,bZ),bV(bW+bZ,bX-bZ)));}bU=n.length(bT);return bV(0,bU);};bb.concat=function(bQ){var bR,bS;bR=[];for(var bT in bQ)bR.push.apply(bR,bQ[bT]);return bR;};bc.concat=function(bQ,bR){return n.ofSeq(bR).join(bQ);};bc.SplitChars=function(bQ,bR,bS){return bc.Split(bQ,new a.RegExp("["+bc.RegexEscape(bR.join(""))+"]"),bS);};bc.StartsWith=function(bQ,bR){return bQ.substring(0,bR.length)==bR;};bc.Split=function(bQ,bR,bS){return bS===1?n.filter(function(bT){return bT!=="";},bc.SplitWith(bQ,bR)):bc.SplitWith(bQ,bR);};bc.RegexEscape=function(bQ){return bQ.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};bc.SplitWith=function(bQ,bR){return bQ.split(bR);};bc.forall=function(bQ,bR){return H.forall(bQ,bc.protect(bR));};bc.protect=function(bQ){return bQ===null?"":bQ;};be.New=function(bQ,bR,bS,bT){var bU;bU={DynElem:bQ,DynFlags:bR,DynNodes:bS};bL.SetOptional(bU,"OnAfterRender",bT);return bU;};bg.New=function(bQ,bR){return{PreviousNodes:bQ,Top:bR};};bh.get_Empty=function(){return{$:0,$0:new F.New$3()};};bh.FindAll=function(bQ){var bR;function bS(bU){if(bU!=null&&bU.$==0){bS(bU.$0);bS(bU.$1);}else if(bU!=null&&bU.$==1)bT(bU.$0);else if(bU!=null&&bU.$==2)bS(bU.$0.Current);else if(bU!=null&&bU.$==6)n.iter(bT,bU.$0.Holes);}function bT(bU){bR.push(bU);bS(bU.Children);}bR=[];bS(bQ);return{$:0,$0:new F.New$2(bR)};};bh.Filter=function(bQ,bR){return{$:0,$0:bw.Filter(bQ,bR.$0)};};bh.Except=function(bQ,bR){return{$:0,$0:bw.Except(bQ.$0,bR.$0)};};bh.ToArray=function(bQ){return bw.ToArray(bQ.$0);};bh.Intersect=function(bQ,bR){return{$:0,$0:bw.Intersect(bQ.$0,bR.$0)};};bi.UseAnimations=function(){bn.$cctor();return bn.UseAnimations;};bi.Actions=function(bQ){return bi.ConcatActions(n.choose(function(bR){return bR.$==1?{$:1,$0:bR.$0}:null;},bp.ToArray(bQ.$0)));};bi.Finalize=function(bQ){n.iter(function(bR){if(bR.$==0)bR.$0();},bp.ToArray(bQ.$0));};bi.ConcatActions=function(bQ){var bR,bS,bT,bU;bR=ba.ofSeqNonCopying(bQ);bS=n.length(bR);return bS===0?bi.Const():bS===1?n.get(bR,0):(bT=H.max(H.map(function(bV){return bV.Duration;},bR)),(bU=n.map(function(bV){return bi.Prolong(bT,bV);},bR),bi.Def(bT,function(bV){n.iter(function(bW){bW.Compute(bV);},bU);})));};bi.List=function(bQ){return bQ.$0;};bi.Const=function(bQ){return bi.Def(0,function(){return bQ;});};bi.Def=function(bQ,bR){return{Compute:bR,Duration:bQ};};bi.Prolong=function(bQ,bR){var bS,bT,bU;bS=bR.Compute;bT=bR.Duration;bU=bE.Create(function(){return bR.Compute(bR.Duration);});return{Compute:function(bV){return bV>=bT?bU.f():bS(bV);},Duration:bQ};};bj.$cctor=function(){bj.$cctor=a.ignore;bj.BatchUpdatesEnabled=true;};bk=f.Updates=bL.Class({},null,bk);bk.Create=function(bQ){var bR;bR=null;bR=bk.New(bQ,null,function(){var bS;bS=bR.s;return bS===null?(bS=t.Copy(bR.c()),bR.s=bS,t.WhenObsoleteRun(bS,function(){bR.s=null;}),bS):bS;});return bR;};bk.New=function(bQ,bR,bS){return new bk({c:bQ,s:bR,v:bS});};bm=bl.T=bL.Class({GetEnumerator:function(){return new S.New(this,null,function(bQ){var bR;bR=bQ.s;return bR.$==0?false:(bQ.c=bR.$0,bQ.s=bR.$1,true);},void 0);},GetEnumerator0:function(){return R.Get(this);}},null,bm);bm.Empty=new bm({$:0});bn.$cctor=function(){bn.$cctor=a.ignore;bn.CubicInOut=bs.Custom(function(bQ){var bR;bR=bQ*bQ;return 3*bR-2*(bR*bQ);});bn.UseAnimations=true;};bo.Delay=function(bQ){return function(bR){try{(bQ(null))(bR);}catch(bS){bR.k({$:1,$0:bS});}};};bo.Bind=function(bQ,bR){return bo.checkCancel(function(bS){bQ(bt.New(function(bT){var bU;if(bT.$==0){bU=bT.$0;bo.scheduler().Fork(function(){try{(bR(bU))(bS);}catch(bV){bS.k({$:1,$0:bV});}});}else bo.scheduler().Fork(function(){bS.k(bT);});},bS.ct));});};bo.Zero=function(){bu.$cctor();return bu.Zero;};bo.Start=function(bQ,bR){var bS,bT;bS=(bT=(bo.defCTS())[0],bR==null?bT:bR.$0);bo.scheduler().Fork(function(){if(!bS.c)bQ(bt.New(function(bU){if(bU.$==1)bo.UncaughtAsyncError(bU.$0);},bS));});};bo.Return=function(bQ){return function(bR){bR.k({$:0,$0:bQ});};};bo.checkCancel=function(bQ){return function(bR){if(bR.ct.c)bo.cancel(bR);else bQ(bR);};};bo.defCTS=function(){bu.$cctor();return bu.defCTS;};bo.UncaughtAsyncError=function(bQ){bN.log("WebSharper: Uncaught asynchronous exception",bQ);};bo.FromContinuations=function(bQ){return function(bR){var bS;function bT(bU){if(bS[0])i.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{bS[0]=true;bo.scheduler().Fork(bU);}}bS=[false];bQ(function(bU){bT(function(){bR.k({$:0,$0:bU});});},function(bU){bT(function(){bR.k({$:1,$0:bU});});},function(bU){bT(function(){bR.k({$:2,$0:bU});});});};};bo.cancel=function(bQ){bQ.k({$:2,$0:new bD.New(bQ.ct)});};bo.scheduler=function(){bu.$cctor();return bu.scheduler;};bp.Append=function(bQ,bR){return bQ.$==0?bR:bR.$==0?bQ:{$:2,$0:bQ,$1:bR};};bp.ToArray=function(bQ){var bR;function bS(bT){if(bT.$==1)bR.push(bT.$0);else if(bT.$==2){bS(bT.$0);bS(bT.$1);}else if(bT.$==3)n.iter(function(bU){bR.push(bU);},bT.$0);}bR=[];bS(bQ);return bR.slice(0);};bp.Concat=function(bQ){var bR;bR=ba.ofSeqNonCopying(bQ);return ba.TreeReduce(bp.Empty(),bp.Append,bR);};bp.Empty=function(){bF.$cctor();return bF.Empty;};bl.head=function(bQ){return bQ.$==1?bQ.$0:bl.listEmpty();};bl.tail=function(bQ){return bQ.$==1?bQ.$1:bl.listEmpty();};bl.listEmpty=function(){return i.FailWith("The input list was empty.");};bq.$cctor=function(){bq.$cctor=a.ignore;bq.EmptyAttr=null;};br.Clear=function(bQ){bQ.splice(0,n.length(bQ));};bs=f.Easing=bL.Class({},e,bs);bs.Custom=function(bQ){return new bs.New(bQ);};bs.New=bL.Ctor(function(bQ){e.New.call(this);this.transformTime=bQ;},bs);bt.New=function(bQ,bR){return{k:bQ,ct:bR};};bu.$cctor=function(){bu.$cctor=a.ignore;bu.noneCT=bv.New(false,[]);bu.scheduler=new by.New();bu.defCTS=[new bz.New()];bu.Zero=bo.Return();bu.GetCT=function(bQ){bQ.k({$:0,$0:bQ.ct});};};bv.New=function(bQ,bR){return{c:bQ,r:bR};};bw.Filter=function(bQ,bR){return new F.New$2(n.filter(bQ,bw.ToArray(bR)));};bw.Except=function(bQ,bR){var bS;bS=new F.New$2(bw.ToArray(bR));bS.ExceptWith(bw.ToArray(bQ));return bS;};bw.ToArray=function(bQ){var bR;bR=n.create(bQ.get_Count(),void 0);bQ.CopyTo(bR);return bR;};bw.Intersect=function(bQ,bR){var bS;bS=new F.New$2(bw.ToArray(bQ));bS.IntersectWith(bw.ToArray(bR));return bS;};bx.isBlank=function(bQ){return bc.forall(bB.IsWhiteSpace,bQ);};by=bo.Scheduler=bL.Class({Fork:function(bQ){var bR;bR=this;this.robin.push(bQ);this.idle?(this.idle=false,a.setTimeout(function(){bR.tick();},0)):void 0;},tick:function(){var bQ,bR,bS;bR=this;bS=bP.now();bQ=true;while(bQ)if(this.robin.length===0){this.idle=true;bQ=false;}else{(this.robin.shift())();bP.now()-bS>40?(a.setTimeout(function(){bR.tick();},0),bQ=false):void 0;}}},e,by);by.New=bL.Ctor(function(){e.New.call(this);this.idle=true;this.robin=[];},by);bz=d.CancellationTokenSource=bL.Class({},e,bz);bz.New=bL.Ctor(function(){e.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},bz);bA.Children=function(bQ,bR){var bS,bT,bU;if(bR!=null&&bR.$==1){bU=[];bS=bR.$0[0].nextSibling;while(bS!==bR.$0[1]){bU.push(bS);bS=bS.nextSibling;}return{$:0,$0:bU};}else return{$:0,$0:n.init(bQ.childNodes.length,(bT=bQ.childNodes,function(bV){return bT[bV];}))};};bA.Except=function(bQ,bR){var bS;bS=bQ.$0;return{$:0,$0:n.filter(function(bT){return n.forall(function(bU){return!(bT===bU);},bS);},bR.$0)};};bA.Iter=function(bQ,bR){n.iter(bQ,bR.$0);};bA.DocChildren=function(bQ){var bR;function bS(bT){if(bT!=null&&bT.$==2)bS(bT.$0.Current);else if(bT!=null&&bT.$==1)bR.push(bT.$0.El);else if(bT==null);else if(bT!=null&&bT.$==5)bR.push(bT.$0);else if(bT!=null&&bT.$==4)bR.push(bT.$0.Text);else if(bT!=null&&bT.$==6)n.iter(function(bU){if(bU==null||bU.constructor===P)bS(bU);else bR.push(bU);},bT.$0.Els);else{bS(bT.$0);bS(bT.$1);}}bR=[];bS(bQ.Children);return{$:0,$0:ba.ofSeqNonCopying(bR)};};bB.IsWhiteSpace=function(bQ){return bQ.match(new a.RegExp("\\s"))!==null;};V.TryParse=function(bQ,bR,bS,bT){var bU,bV;bU=+bQ;bV=bU===bU-bU%1&&bU>=bR&&bU<=bS;bV?bT.set(bU):void 0;return bV;};bD=d.OperationCanceledException=bL.Class({},bC,bD);bD.New=bL.Ctor(function(bQ){bD.New$1.call(this,"The operation was canceled.",null,bQ);},bD);bD.New$1=bL.Ctor(function(bQ,bR,bS){this.message=bQ;this.inner=bR;P.setPrototypeOf(this,bD.prototype);this.ct=bS;},bD);bE.Create=function(bQ){return bH.New(false,bQ,bE.forceLazy);};bE.forceLazy=function(){var bQ;bQ=this.v();this.c=true;this.v=bQ;this.f=bE.cachedLazy;return bQ;};bE.cachedLazy=function(){return this.v;};bF.$cctor=function(){bF.$cctor=a.ignore;bF.Empty={$:0};};bH.New=function(bQ,bR,bS){return{c:bQ,v:bR,f:bS};};bL.OnLoad(function(){c.Main();});}());


if (typeof IntelliFactory !=='undefined') {
  IntelliFactory.Runtime.ScriptBasePath = '/Content/';
  IntelliFactory.Runtime.Start();
}
